{% extends 'designers/base.html' %}
{% load static %}
{% load custom_tags %}
{% load cache %}
{% load thumbnail %}


{% block meta_description %}{% if meta.description %}{{ meta.description }}{% else %}{{object.title}}{% endif %}{% endblock %}

{% block meta_og_type %}profile{% endblock %}
{% block meta_og_title %}{% if meta.title %}{{ meta.title }}{% else %}{{object.title}}{% endif %}{% endblock %}
{% block meta_og_description %}{% if meta.description %}{{ meta.description }}{% else %}{{object.title}}{% endif %}{% endblock %}
{% block meta_og_image %}{{site_url}}{% get_media_prefix %}{{ object.logo }}{% endblock %}

{% block styles %}
{% endblock %}

{% block script %}
	<script type="text/javascript" src="{% static 'js/masonry-portfolio.min.js' %}" defer></script>
{% endblock script %}

{% block title %}{{ block.super }} {{separator}} Портфолио работ{% endblock %}


{% block svg_icons %}

{{ block.super }}
<symbol id="award-icon" width="100%" height="100%" fill="orange" viewBox="0 0 16 16">
	<path d="m8 0 1.669.864 1.858.282.842 1.68 1.337 1.32L13.4 6l.306 1.854-1.337 1.32-.842 1.68-1.858.282L8 12l-1.669-.864-1.858-.282-.842-1.68-1.337-1.32L2.6 6l-.306-1.854 1.337-1.32.842-1.68L6.331.864 8 0z"/>
	<path d="M4 11.794V16l4-1 4 1v-4.206l-2.018.306L8 13.126 6.018 12.1 4 11.794z"/>
</symbol>

{% endblock svg_icons %}



{% block header %}

	{% block brand_block %}
	{{ block.super }}

	<a href="{{object.get_absolute_url}}" class="back-link">
		<svg class="icon arrow-icon"><use xlink:href="#arrow-icon"></use></svg>&nbsp;Назад
	</a>
	{% endblock brand_block %}

	<div id="filterBlock" class="filters-group navigation centered gap-4">

		<div class="button-group all">
			<button class="category-link is-checked" type="button" data-filter="*">все проекты</button>
		</div>
		<div class="button-group category-filters">
		{% for key, value in filter_attributes %}
			<button class="category-link text-weight" type="button" data-filter=".{{key}}">{{value}}</button>
		{% endfor %}
		</div>

	</div>
{% endblock header %}


{% block content %}

	{% if portfolio_list %}
		<div id="portfolioBlock" class="portfolio-container loading">
			<div class="grid-sizer"></div>
			{% for e in portfolio_list %}

				{% with cover=e.project_cover %}
				{% if cover %}

				{% with nominations=e.nominations_list %}
				{% with categories=e.categories_list %}
				<a id="project-{{e.id}}" class="grid-cell grid-item {% for n in nominations %}{% ifchanged %} {{n.category.slug}}{% endifchanged %}{% endfor %} {% for c in categories %}{% ifchanged %} {{c.slug}}{% endifchanged %}{% endfor %}" href="{{ e.get_absolute_url }}">
					<figure>
						{% thumbnail cover "320" crop="center" as xs %}
						{% thumbnail cover "576" crop="center" as sm %}
						{% thumbnail cover "992" crop="center" as md %}
						<img class="project-cover slide-img lazyload"
							src="{{ xs.url }}"
							srcset="{{ xs.url }} {{ xs.x }}w, {{ sm.url }} {{ sm.x }}w, {{ md.url }} {{ md.x }}w">
						{% endthumbnail %}
						{% endthumbnail %}
						{% endthumbnail %}

						<figcaption>
							{% if e.title  %}
							<h4 class="title">{{ e.title }}</h4>
							{% endif %}

							{% if e.win_year %}
							<div class="portfolio-award" title="Победитель в выставке Сфера дизайна {{e.win_year}}">
								<svg class="award"><use xlink:href="#award-icon"></use></svg>
							</div>
							{% endif %}

							<div class="meta text-weight">
								<div class="detail">
									{% if e.win_year %}
									Победитель в выставке<span>Сфера Дизайна {{ e.win_year }}</span>
									{% elif e.exh_year %}
									Участие в выставке<span>Сфера Дизайна {{ e.exh_year }}</span>
									{% else %}
									Вневыставочный проект
									{% endif %}
								</div>

								{% if nominations %}
								<div class="category">
									Категория:
									<span>
									{% for n in nominations %}
									{% if forloop.first %}{{n.category.title}}{% else %}{% ifchanged %}/ {{n.category.title}}{% endifchanged %}{% endif %}
									{% endfor %}
									</span>
								</div>
								{% elif categories %}
								<div class="category">
									Категория:
									<span>
									{% for c in categories %}
									{% if forloop.first %}{{c.title}}{% else %}{% ifchanged %}/ {{c.title}}{% endifchanged %}{% endif %}
									{% endfor %}
									</span>
								</div>
								{% endif %}
							</div>
						</figcaption>

					</figure>
				</a>
				{% endwith %}
				{% endwith %}

				{% endif %}
				{% endwith %}

			{% endfor %}
	</div>

	<!-- status elements -->
	<div class="page-load-status">
		<div id="preloader" class="infinite-scroll-request centered fade">
			<div class="dot"></div>
			<div class="dot"></div>
			<div class="dot"></div>
			<div class="dot"></div>
			<div class="dot"></div>
		</div>
		{% if user.is_authenticated %}
		<a href="/portfolio/new" class="centered">Добавить портфолио</a>
		{% else %}
		<p class="infinite-scroll-error centered">Конец списка</p>
		{% endif %}
	</div>
	<!-- pagination has path -->
	<p class="pagination">
		<a class="btn pagination__next" type="button" href="page2.html">Еще портфолио</a>
	</p>
	{% endif %}

{% endblock content %}

{% block extra_container %}{% endblock extra_container %}
