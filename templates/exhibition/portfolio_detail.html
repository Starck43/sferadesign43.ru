{% extends 'base.html' %}
{% load static %}
{% load custom_tags %}
{% load thumbnail %}

{% block styles %}
<link href="{% static 'css/portfolio.min.css' %}" rel="stylesheet" type="text/css" media="screen"/>
{% endblock %}

{% block script %}
<script type="text/javascript">
	{% if is_mobile %}
	var is_mobile = true;
	{% else %}
	var is_mobile = false;
	{% endif %}
</script>

{% if not is_mobile %}
<script type="text/javascript" src="{% static 'js/peppermint.min.js' %}"></script>
<script type="text/javascript" src="{% static 'js/masonry.pkgd.min.js' %}"></script>
{% endif %}


<script type="text/javascript" src="{% static 'js/slider.min.js' %}"></script>

{% endblock script %}

{% block header %}
	<h1>{% if portfolio %}{{ object.title }}{% else %}Портфолио пока не создано!{% endif %}</h1>
{% endblock header %}

{% block content %}
	<div class="content">

		{% if portfolio %}

		<a href="{{parent_link}}" class="back-link"><svg class="icon arrow-icon"><use xlink:href="#arrow-icon"></use></svg>&nbsp;Назад</a>
		<section class="portfolio">
			<div class="portfolio-owner">Автор работы: <a href="{{ portfolio.owner.get_absolute_url }}">{{ portfolio.owner }}</a></div>
			<div class="portfolio-exhibition">Участие в выставке: <a href="{% url 'exhibition-detail-url' portfolio.exhibition.slug %}">{{portfolio.exhibition}}</a></div>

			{% if portfolio.images %}
			<div class="portfolio-list my-3{% if is_mobile %} grid{% endif %}">
				{% if not is_mobile %}<div class="grid-sizer"></div>{% endif %}
				{% include "exhibition/images_list.html" %}
			</div>
			{% endif %}

			{% if portfolio.description %}
			<div class="portfolio-description description">{{ portfolio.description|safe }}</div>
			{% endif %}
		</section>
		{% else %}
			<a href="{{parent_link}}">Вернуться к разделам портфолио</a>
		{% endif %}
	</div>
{% endblock %}


{% block extra_container %}

	{% if portfolio.images %}
	<div id="overlay" class="modal">

		{% if not is_mobile %}

		<div id="slides-block" class="fade">
			{% for img in portfolio.images.all %}
			<figure class="slide-wrapper centered">

				{% thumbnail img.file "320" as xs %}
				{% thumbnail img.file "576" as sm %}
				{% thumbnail img.file "992" as md %}
				{% thumbnail img.file "1200" as xl %}
				<img class="slide-img lazyload"
					src="{{ img.file }}"
					srcset="{{ xs.url }} {{ xs.x }}w, {{ sm.url }} {{ sm.x }}w, {{ md.url }} {{ md.x }}w, {{ xl.url }} {{ xl.x }}w"
					data-sizes="auto"
					data-expand="-50"
					loading="lazy"
					style="max-width: {{ img.file.width }}px"
					title="{% if img.title %}{{ img.title }}{% endif %}">
				{% empty %}
				<img src="{% get_media_prefix %}no-image.png">
				{% endthumbnail %}
				{% endthumbnail %}
				{% endthumbnail %}
				{% endthumbnail %}
				{% if img.title or img.description %}
				<figcaption class="centered">
					{% if img.title %}
					<h3 class="slide-title">{{ img.title }}</h3>
					{% endif %}
					{% if img.description %}
					<p class="slide-description">{{ img.description }}</p>
					{% endif %}
				</figcaption>
				{% endif %}

			</figure>
			{% endfor %}

		</div>

		{% endif %}

		<a class="controls-block no-select" href="#">
			{% if portfolio.images.count > 1 %}
			<svg id="arrow-left" class="arrow-icon icon"><use xlink:href="#arrow-icon"></use></svg>
			<svg id="arrow-right" class="arrow-icon icon"><use xlink:href="#arrow-icon"></use></svg>
			{% endif %}
			<svg id="close-button" class="close-icon icon"><use xlink:href="#close-icon"></use></svg>
		</a>
	</div>
	{% endif %}

{% endblock extra_container %}
