{% extends 'base.html' %}

{% load static %}
{% load crispy_forms_tags %}

{% block header %}
	{% if user.is_authenticated %}
		<h1>Добавить новое портфолио</h1>
	{% else %}
		<h1>Доступ закрыт</h1>
	{% endif %}
{% endblock header %}

{% block content %}
	{% if user.is_authenticated %}
		<p>Вы вошли как: <i><b>{{user.username}}</b> ({{user.first_name}} {{user.last_name}})</i></p>
		<form class="upload-form" autocomplete="off" enctype="multipart/form-data" method="post">
			{% csrf_token %}

			{% for field in form %}
				{% if field.errors %}
				<div class="alert alert-danger">
					{{ field.errors }}
				</div>
				{% endif %}
				{% if not user.is_staff and field.name == 'owner' %}
					<div>{{field.label}}: <b>{{exhibitor}}</b></div>
					{{ field.as_hidden }}
				{% else %}
					{{ field|as_crispy_field }}
				{% endif %}
			{% endfor %}

			<button class="btn btn-primary mr-2" type="submit">Сохранить</button>
			<a href="/"><button class="btn btn-outline-primary" type="button">На главную</button></a>
		</form>
	{% else %}
		<p>Для выгрузки портфолио на сайт Вы должны быть зарегистрированы как участник выставки!</p>
		<a href="{{ signup_url }}">Зарегистрироваться</a>
	{% endif %}
{% endblock %}

