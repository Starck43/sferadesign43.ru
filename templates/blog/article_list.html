{% extends 'base.html' %}
{% load static %}
{% load custom_tags %}
{% load cache %}

{% block title %}{{ block.super }} {{separator}} {{ category_title }}{% endblock %}


{% block script %}
{{ block.super }}
<script type="text/javascript" src="{% md5url 'js/articles.min.js' %}"></script>
{% endblock script %}


{% block page_title %}{{page_title}}{% endblock page_title %}


{% block sidebar %}

{% cache cache_timeout sidebar articles %}

{% if filter_attributes %}
<div id="articleFilter" class="sidebar-inner">
	<h3 class="sidebar-title">темы</h3>

	<form class="article-categories" action="{% url 'blog:article-list-url' %}" method="get" name="articles-filter">
		{% for item in filter_attributes %}
		<div class="category-item nav-item">
			<input class="btn-check" id="category-{{item.id}}_id" type="radio" name="article-category" value="{{item.id}}" autocomplete="off">
			<label class="form-label nav-title" for="category-{{item.id}}_id">{{ item.name }}</label>
			<span class="badge counter btn-primary">{{item.count}}</span>
		</div>
		{% endfor %}
		<div class="category-item nav-item">
			<input class="btn-check" id="all-category_id" type="radio" name="article-category" value="all" autocomplete="off" checked>
			<label class="form-label nav-title" for="all-category_id">все статьи</label>
		</div>
	</form>
</div>
{% endif %}

{% endcache %}

{% endblock sidebar %}


{% block content %}

{% cache cache_timeout articles %}

	<div id="articleList">
		{% for article in article_list %}
		<article id="article-{{article.id}}" class="article-content">
			<h2 class="article-title "><a href="{% url 'blog:article-detail-url' article.id %}">{{ article.title }}</a></h2>

			{% with article.person as person %}
			{% if person %}
			<span>автор: </span><a class="article-author" href="{{person.get_absolute_url}}"><i><b>{{ person.name }}</b></i></a>
			{% endif %}
			{% endwith %}

			<div class="modified-date">{{article.modified_date|date:"d.m.Y"}}</div>
			<div class="article-text">{{article.content|safe|truncatechars_html:300}}</div>
			<span>[<u><i><a href="{% url 'blog:article-detail-url' article.id %}" class="link-dark">читать полностью</a></i></u>]</span>
		</article>
		{% endfor %}

		<a id="preloader" class="centered fade {% if next_page %}show{% endif %}" href="{% url 'blog:article-list-url' %}">
			<div class="dot"></div>
			<div class="dot"></div>
			<div class="dot"></div>
			<div class="dot"></div>
			<div class="dot"></div>
		</a>
	</div>

{% endcache %}

{% endblock content %}


